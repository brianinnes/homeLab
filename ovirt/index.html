<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to create your own home or office Lab environment to explore Red Hat OpenShift using oVirt and OKD"><meta name=author content="Brian Innes"><link href=https://brianinnes.github.io/homeLab/ovirt/ rel=canonical><link rel=icon href=../images/BrianLogo.png><meta name=generator content="mkdocs-1.2.1, mkdocs-material-7.1.8"><title>oVirt setup - Home Lab</title><link rel=stylesheet href=../assets/stylesheets/main.ca7ac06f.min.css><link rel=stylesheet href=../assets/stylesheets/palette.f1a3b89f.min.css><meta name=theme-color content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../css/extra.css></head> <body dir=ltr data-md-color-scheme=brian data-md-color-primary=brian-blue data-md-color-accent=brian-light-green> <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#ovirt-installation-and-setup class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Home Lab" class="md-header__button md-logo" aria-label="Home Lab" data-md-component=logo> <img src=../images/BrianLogo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Home Lab </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> oVirt setup </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/brianinnes/homeLab/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> homeLab </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Home Lab" class="md-nav__button md-logo" aria-label="Home Lab" data-md-component=logo> <img src=../images/BrianLogo.png alt=logo> </a> Home Lab </label> <div class=md-nav__source> <a href=https://github.com/brianinnes/homeLab/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> homeLab </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../preparation/ class=md-nav__link> Preparing </a> </li> <li class=md-nav__item> <a href=../my-setup/ class=md-nav__link> My setup </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> oVirt setup <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> oVirt setup </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#install-ovirt-node class=md-nav__link> Install oVirt node </a> </li> <li class=md-nav__item> <a href=#run-ovirt-setup-wizard class=md-nav__link> Run oVirt setup wizard </a> </li> <li class=md-nav__item> <a href=#optional-create-partition-for-gluster-filesystem class=md-nav__link> (Optional) Create partition for Gluster filesystem </a> </li> <li class=md-nav__item> <a href=#setup-ssh-keys class=md-nav__link> Setup ssh keys </a> </li> <li class=md-nav__item> <a href=#configure-lvm-filter class=md-nav__link> Configure LVM filter </a> </li> <li class=md-nav__item> <a href=#setup-the-hyperconverged-ovirt-hosted-engine-and-gluster-storage class=md-nav__link> Setup the hyperconverged oVirt Hosted Engine and Gluster storage </a> </li> <li class=md-nav__item> <a href=#install-hosted-engine class=md-nav__link> Install Hosted Engine </a> <nav class=md-nav aria-label="Install Hosted Engine"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modify-the-firewall-rules class=md-nav__link> Modify the firewall rules </a> </li> <li class=md-nav__item> <a href=#install-the-hosted-engine class=md-nav__link> Install the Hosted Engine </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setup-console-viewing-app class=md-nav__link> Setup Console viewing app </a> <nav class=md-nav aria-label="Setup Console viewing app"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ovirt-machine-console-on-macos class=md-nav__link> oVirt machine console on macOS </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../workstation/ class=md-nav__link> Hosted workstation </a> </li> <li class=md-nav__item> <a href=../okd_install/ class=md-nav__link> OKD install </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> Development Environment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Development Environment" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Development Environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../devops/ class=md-nav__link> DevOps </a> </li> <li class=md-nav__item> <a href=../devops/objectStorage/ class=md-nav__link> Object Storage </a> </li> <li class=md-nav__item> <a href=../devops/registry/ class=md-nav__link> Container Registry </a> </li> <li class=md-nav__item> <a href=../devops/argocd/ class=md-nav__link> ArgoCD </a> </li> <li class=md-nav__item> <a href=../devops/pipelines/ class=md-nav__link> Pipelines </a> </li> <li class=md-nav__item> <a href=../devops/gitea/ class=md-nav__link> Gitea </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../resources/ class=md-nav__link> Resources </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#install-ovirt-node class=md-nav__link> Install oVirt node </a> </li> <li class=md-nav__item> <a href=#run-ovirt-setup-wizard class=md-nav__link> Run oVirt setup wizard </a> </li> <li class=md-nav__item> <a href=#optional-create-partition-for-gluster-filesystem class=md-nav__link> (Optional) Create partition for Gluster filesystem </a> </li> <li class=md-nav__item> <a href=#setup-ssh-keys class=md-nav__link> Setup ssh keys </a> </li> <li class=md-nav__item> <a href=#configure-lvm-filter class=md-nav__link> Configure LVM filter </a> </li> <li class=md-nav__item> <a href=#setup-the-hyperconverged-ovirt-hosted-engine-and-gluster-storage class=md-nav__link> Setup the hyperconverged oVirt Hosted Engine and Gluster storage </a> </li> <li class=md-nav__item> <a href=#install-hosted-engine class=md-nav__link> Install Hosted Engine </a> <nav class=md-nav aria-label="Install Hosted Engine"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modify-the-firewall-rules class=md-nav__link> Modify the firewall rules </a> </li> <li class=md-nav__item> <a href=#install-the-hosted-engine class=md-nav__link> Install the Hosted Engine </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setup-console-viewing-app class=md-nav__link> Setup Console viewing app </a> <nav class=md-nav aria-label="Setup Console viewing app"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ovirt-machine-console-on-macos class=md-nav__link> oVirt machine console on macOS </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/brianinnes/homeLab/edit/main/docs/ovirt.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=ovirt-installation-and-setup>oVirt installation and setup<a class=headerlink href=#ovirt-installation-and-setup title="Permanent link">&para;</a></h1> <!--- cSpell:ignore passwordless OOMY hyperconverged vdsm firewalld wipefs remoteviewer virt jeffreywildman --> <h2 id=install-ovirt-node>Install oVirt node<a class=headerlink href=#install-ovirt-node title="Permanent link">&para;</a></h2> <ul> <li><a href=https://ovirt.org/download/ target=_blank>download ISO</a>. You want the <a href=https://resources.ovirt.org/pub/ovirt-4.4/iso/ovirt-node-ng-installer/ target=_blank>oVirt Node</a> ISO.</li> <li>flash to USB memory stick</li> <li>Boot from memory stick</li> </ul> <h2 id=run-ovirt-setup-wizard>Run oVirt setup wizard<a class=headerlink href=#run-ovirt-setup-wizard title="Permanent link">&para;</a></h2> <ol> <li>Select language from the list then press the <strong>Continue</strong> button</li> <li>Select the keyboard layout then press the <strong>Done</strong> key</li> <li>Enter the <strong>Installation Destination</strong> section<ul> <li>you need to keep a disk or partition free for Gluster to use (this was discussed in the <a href=../preparation/ target=_blank>preparation</a> section)</li> </ul> </li> <li>Enter a root password</li> <li>Set the TimeZone</li> <li>Enter the Network and Host name section (ovirt host details - <strong>z840.home.lab</strong> in my setup)<ul> <li>select <strong>Configure</strong> to configure the network interface</li> <li>In the IPv4 tab select <strong>Manual</strong> configuration then select <strong>Add</strong> to enter the configuration - this should match what is in your DNS configuration. Press <strong>Save</strong> to store the IP configuration</li> <li>Click the toggle switch to enable the Ethernet interface</li> <li>Select Done to complete the network configuration</li> </ul> </li> <li>(optional) If you want to configure NTP time synchronisation, revisit the <strong>Time &amp; Date</strong> section and configure the NTP server to a local server then enable NTP</li> <li>Select <strong>Begin Installation</strong> to start the installation</li> <li>Wait for installation to complete then select to reboot when selected (ensure the USB memory stick is removed so it doesn't boot from the install media)</li> <li>You can now interact with the installed system using the web based cockpit UI. On your laptop or a workstation on the network, navigate to <code>https://&lt;host address&gt;:9090</code>. Where the host address is the address you added in DNS for the IP address you manually configured in step 6 above.</li> </ol> <h2 id=optional-create-partition-for-gluster-filesystem>(Optional) Create partition for Gluster filesystem<a class=headerlink href=#optional-create-partition-for-gluster-filesystem title="Permanent link">&para;</a></h2> <p>If you are using a disk partition for the Gluster FS, then you need to create the partition. In the cockpit UI, navigate to the <strong>Storage</strong> section. Select the disk where the partition will live from the side panel. This will show the partitions in the Content section. Next to the unallocated space there is a <strong>Create partition</strong> button. Click the button to create a partition. Set the required size and select <strong>No filesystem</strong> as the type then click <strong>Create partition</strong> to create the partition.</p> <h2 id=setup-ssh-keys>Setup ssh keys<a class=headerlink href=#setup-ssh-keys title="Permanent link">&para;</a></h2> <p>During the install the ansible scripts need to be able to execute commands on the host. To do this it uses passwordless ssh. Even though we are only using a single host, the scripts are written to work across multiple hosts, so we need to enable passwordless ssh.</p> <p>You need to know your host IP address to substitute into <code>ssh-copy-id</code> command. You can find your host address using command <code>hostname -I</code></p> <p>Enter the following commands using the terminal section of the cockpit web console (<code>http://&lt;host-address&gt;:9090</code>) for the oVirt host. Substitute your host address in the copy command, accept all defaults and leave the passphrase blank:</p> <div class=highlight><pre><span></span><code>ssh-keygen
ssh-copy-id root@&lt;host-address&gt;
</code></pre></div> <p>you will be prompted to confirm the connection, answer <strong>yes</strong> then you will be prompted for the root password, which you entered in step 4 of the previous section.</p> <h2 id=configure-lvm-filter>Configure LVM filter<a class=headerlink href=#configure-lvm-filter title="Permanent link">&para;</a></h2> <p>By default Logical Volumes are configured to specific devices, so you need to add the device you want to use for the Gluster storage.</p> <p>Using the terminal section in the cockpit web ui, edit file <strong>/etc/lvm/lvm.conf</strong> and search for a line the starts <strong>filter =</strong>, not lines starting with <strong>#</strong> are comments.</p> <p>Modify the line to include your chosen device for the gluster volumes,</p> <p>eg. If the filter is currently set to <code>filter = ["a|^/dev/disk/by-id/lvm-pv-uuid-U77HZ9-LPry-OOMY-bgOq-t34w-l3av-srg8tU$|", "r|.*|"]</code> and your chosen device is <strong>/dev/sdb</strong>, then the filter line needs to be modified to:</p> <div class=highlight><pre><span></span><code>filter = [&quot;a|^/dev/disk/by-id/lvm-pv-uuid-U77HZ9-LPry-OOMY-bgOq-t34w-l3av-srg8tU$|&quot;, &quot;a|^/dev/sdb|&quot;, &quot;r|.*|&quot;]
</code></pre></div> <p>Save the modified lvm.conf file</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If you plan to use an entire disk for GlusterFS, then it is important that the disk is not partitioned, so if it has previously been used and has a partition table on it, then use the <strong>Terminal</strong> section of the cockpit interface to clear the device. E.g. if you will be using the disk <strong>/dev/sdb</strong> for gluster, then wipe the disk using command <code>wipefs -a -f /dev/sdb</code>. This will erase the disk.</p> </div> <h2 id=setup-the-hyperconverged-ovirt-hosted-engine-and-gluster-storage>Setup the hyperconverged oVirt Hosted Engine and Gluster storage<a class=headerlink href=#setup-the-hyperconverged-ovirt-hosted-engine-and-gluster-storage title="Permanent link">&para;</a></h2> <p>The hyperconverged Hosted Engine and Gluster storage can be installed using the cockpit web console (<code>http://&lt;host-address&gt;:9090</code>).</p> <p>In the Cockpit UI navigate to the <strong>Virtualization</strong> section in the side menu, then select the Hosted Engine section.</p> <p><img alt="cockpit virtualization" src=../images/cockpitHostedEngine.png></p> <p>Select the start button under Hyperconverged.</p> <p>Select the <strong>Run Gluster Wizard for Single Node</strong> option to start the install.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Step 5 is only required in oVirt versions 4.4.6 and earlier, from 4.4.7 the installer works without needing to modify the generated config</p> </div> <ol> <li>Enter the Fully qualified hostname for the oVirt cluster (this should be the name of the oVirt node that was used during the <code>ssh-copy-id</code> command)</li> <li>You can leave the Packages options as default</li> <li>You can leave the Volumes options as default. However, if you have a small amount of storage you may want to delete 2 of the 3 default volumes, so all available storage will be in a single volume.</li> <li>In the Bricks options, set the device to the device you have available for the gluster storage for all the configured volumes. This could be an entire disk (e.g. /dev/sdb), or an available disk partition (/dev/sda3)</li> <li><em>(only for earlier versions of oVirt)</em> In the review section edit the summary and remove the line <code>- 5900/tcp</code>, as this will cause the scripts to fail. Save the script</li> <li>Select the Deploy button to start the Gluster Storage installation</li> </ol> <p>If all works you should see the screen confirming the Gluster installation was successful</p> <p><img alt="Gluster success" src=../images/glusterSuccess.png></p> <p>You can now select the <strong>Continue to Hosted Engine Deployment</strong> button to install the Hosted Engine.</p> <h2 id=install-hosted-engine>Install Hosted Engine<a class=headerlink href=#install-hosted-engine title="Permanent link">&para;</a></h2> <p>The Hosted Engine will try to add port 6900 to the public zone and will fail as the port is already being exposed. Before installing the Hosted Engine you need to modify the firewall configuration.</p> <h3 id=modify-the-firewall-rules>Modify the firewall rules<a class=headerlink href=#modify-the-firewall-rules title="Permanent link">&para;</a></h3> <div class="admonition info"> <p class=admonition-title>Info</p> <p>This step was needed in versions of ovirt before 4.4.9, but is no longer needed with 4.4.10</p> </div> <p>You need to modify the firewall config to remove port 6900 to ensure the automated deployment will work.</p> <ol> <li> <p>Switch to the terminal section and edit the file <strong>/etc/firewalld/zones/public.xml</strong> to have the following content:</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;zone&gt;</span>
  <span class=nt>&lt;short&gt;</span>Public<span class=nt>&lt;/short&gt;</span>
  <span class=nt>&lt;description&gt;</span>For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.<span class=nt>&lt;/description&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;ssh&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;dhcpv6-client&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;cockpit&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;libvirt&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;libvirt-tls&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;glusterfs&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;service</span> <span class=na>name=</span><span class=s>&quot;custom-vdsm&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;2049&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;54321&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;5900-6899&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;6901-6923&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;5666&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
  <span class=nt>&lt;port</span> <span class=na>port=</span><span class=s>&quot;16514&quot;</span> <span class=na>protocol=</span><span class=s>&quot;tcp&quot;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;/zone&gt;</span>
</code></pre></div> <p>You can see the port range 5900-6923 has been split into 2 ranges avoiding port 6900</p> </li> <li> <p>run command <code>systemctl restart firewalld</code> to make the new firewall configuration live. You can now return to the Virtualization section of the Cockpit web console to continue with the Hosted Engine deployment.</p> </li> </ol> <h3 id=install-the-hosted-engine>Install the Hosted Engine<a class=headerlink href=#install-the-hosted-engine title="Permanent link">&para;</a></h3> <p>Select to Deploy the Hosted Engine</p> <ol> <li>In the VM Settings section enter:<ul> <li>the fully qualified host name for the hosted engine (<strong>virt.home.lab</strong> in my setup)</li> <li>switch to static Network Configuration and set the IP address to the value matching your hostname in your DNS, the gateway address and DNS server address</li> <li>enter the root password you want to set for the hosted engine operating system</li> <li>select <strong>Next</strong> to move to Engine section</li> </ul> </li> <li>In the Engine section enter the admin password you want to set for the Engine, then select **Next to move to the next section</li> <li>Review the configuration information then press <strong>Prepare VM</strong> to deploy the Hosted Engine virtual machine in the Prepare VM section, this can take a while</li> <li>When the VM has been setup press <strong>Next</strong> to complete the setup</li> <li>In the storage section the settings should be pre-populated, so you can press <strong>Next</strong> then <strong>Finish Deployment</strong></li> </ol> <h2 id=setup-console-viewing-app>Setup Console viewing app<a class=headerlink href=#setup-console-viewing-app title="Permanent link">&para;</a></h2> <p>oVirt uses the SPICE protocol to access a hosted virtual machine. You need to have a console viewing application installed on your system. Details can be found <a href=https://www.spice-space.org/download.html target=_blank>here</a></p> <h3 id=ovirt-machine-console-on-macos>oVirt machine console on macOS<a class=headerlink href=#ovirt-machine-console-on-macos title="Permanent link">&para;</a></h3> <p>Setting up the console viewer on MacOS can be a little more involved. </p> <p>When using <a href target=_blank>Homebrew</a>, issue the following commands on the command line:</p> <ul> <li>brew install gtk+3</li> <li>brew tap jeffreywildman/homebrew-virt-manager</li> <li>brew install remoteviewer</li> </ul> <p>then follow the <a href=https://rizvir.com/articles/ovirt-mac-console/ target=_blank>instructions</a> to setup the association of <strong>.vv</strong> files to the remote-viewer application.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../my-setup/ class="md-footer__link md-footer__link--prev" aria-label="Previous: My setup" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> My setup </div> </div> </a> <a href=../workstation/ class="md-footer__link md-footer__link--next" aria-label="Next: Hosted workstation" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Hosted workstation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright © 2021 Brian Innes </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.b0710199.min.js", "version": null}</script> <script src=../assets/javascripts/bundle.76f349be.min.js></script> </body> </html>